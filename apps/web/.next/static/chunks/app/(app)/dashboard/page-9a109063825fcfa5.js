(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[40],{69908:function(e,s,a){Promise.resolve().then(a.bind(a,27209))},27209:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return j}});var l=a(27573),t=a(7653),r=a(32195),i=a(23005),n=a(34463),d=a(39135),c=a(59565);let o=(0,c.Z)("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),u=(0,c.Z)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var m=a(67899),p=a(32937),h=a(77631),x=a(87659),f=a(44251);function j(){var e,s,a;let{data:c}=(0,f.useSession)(),[j,g]=t.useState(null),[y,N]=t.useState(0),[v,b]=t.useState("idle"),[w,k]=t.useState(!1),[S,Z]=t.useState([]);t.useEffect(()=>{var e;if(null==c?void 0:null===(e=c.user)||void 0===e?void 0:e.email){let e=sessionStorage.getItem("pendingUpload");if(e)try{let s=JSON.parse(e);g(s),b("processing"),sessionStorage.removeItem("pendingUpload"),C(s)}catch(e){console.error("Failed to parse pending upload data:",e),sessionStorage.removeItem("pendingUpload")}}},[null==c?void 0:null===(e=c.user)||void 0===e?void 0:e.email]);let C=t.useCallback(async e=>{var s;if(null==c?void 0:null===(s=c.user)||void 0===s?void 0:s.email)try{let s=await fetch("/api/uploads/connect",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uploadId:e.uploadId,fileReferences:e.fileReferences})});if(s.ok){let e=await s.json();I(e.analysisId)}else b("failed")}catch(e){console.error("Failed to connect upload to user:",e),b("failed")}},[null==c?void 0:null===(s=c.user)||void 0===s?void 0:s.email]),I=t.useCallback(e=>{let s=setInterval(async()=>{try{let a=await fetch("/api/analysis/status/".concat(e));if(a.ok){let e=await a.json();N(e.progress||0),"completed"===e.status?(b("completed"),clearInterval(s)):"failed"===e.status&&(b("failed"),clearInterval(s))}}catch(e){console.error("Failed to poll analysis progress:",e)}},2e3);setTimeout(()=>clearInterval(s),3e5)},[]),A=t.useCallback(async e=>{var s;if(console.log("Upload completed:",e),e.fileReferences.forEach((s,a)=>{Z(s=>[...s,{id:"".concat(e.uploadId,"-").concat(a),filename:"File ".concat(a+1),uploadedAt:new Date,status:"processing"}])}),k(!1),null==c?void 0:null===(s=c.user)||void 0===s?void 0:s.email){b("processing"),N(0);try{let s=await fetch("/api/uploads/connect",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uploadId:e.uploadId,fileReferences:e.fileReferences})});if(s.ok){let e=await s.json();console.log("Analysis started with ID:",e.analysisId),I(e.analysisId)}else console.error("Failed to start analysis"),b("failed")}catch(e){console.error("Failed to trigger analysis:",e),b("failed")}}},[null==c?void 0:null===(a=c.user)||void 0===a?void 0:a.email,I]),O=t.useCallback(e=>{console.error("Upload error:",e)},[]),R=t.useCallback(()=>{k(!0)},[]);return(0,l.jsxs)("div",{className:"space-y-8",children:[(0,l.jsxs)("div",{className:"flex items-start justify-between",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Dashboard"}),(0,l.jsx)("p",{className:"text-muted-foreground",children:"processing"===v?"Analyzing your uploaded documents...":"completed"===v?"Your analysis is ready!":"Upload your bank statements to get started with AI-powered analysis"})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:["completed"===v&&(0,l.jsxs)(i.z,{onClick:R,className:"flex items-center gap-2",children:[(0,l.jsx)(d.Z,{className:"h-4 w-4"}),"Upload More Files"]}),(0,l.jsx)(x.default,{href:"/dashboard/history",children:(0,l.jsxs)(i.z,{variant:"outline",className:"flex items-center gap-2",children:[(0,l.jsx)(o,{className:"h-4 w-4"}),"View Report History"]})})]})]}),"processing"===v&&(0,l.jsxs)(n.Zb,{children:[(0,l.jsxs)(n.Ol,{children:[(0,l.jsxs)(n.ll,{className:"flex items-center gap-2",children:[(0,l.jsx)(u,{className:"h-5 w-5"}),"Analyzing Your Documents"]}),(0,l.jsx)(n.SZ,{children:j?"Processing ".concat(j.fileReferences.length," uploaded file(s) from ").concat(new Date(j.uploadedAt).toLocaleString()):"Processing your uploaded documents with AI analysis..."})]}),(0,l.jsx)(n.aY,{children:(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,l.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:{width:"".concat(y,"%")}})}),(0,l.jsxs)("p",{className:"text-sm text-muted-foreground",children:[y,"% complete - This usually takes 1-2 minutes"]})]})})]}),"completed"===v&&(0,l.jsxs)(n.Zb,{children:[(0,l.jsxs)(n.Ol,{children:[(0,l.jsxs)(n.ll,{className:"flex items-center gap-2",children:[(0,l.jsx)(m.Z,{className:"h-5 w-5 text-green-600"}),"Analysis Complete!"]}),(0,l.jsx)(n.SZ,{children:"Your financial analysis is ready. View your detailed insights and reports."})]}),(0,l.jsx)(n.aY,{children:(0,l.jsxs)("div",{className:"flex gap-4",children:[(0,l.jsx)(x.default,{href:"/dashboard/history",children:(0,l.jsx)(i.z,{children:"View Analysis Report"})}),(0,l.jsx)(i.z,{variant:"outline",onClick:R,children:"Upload More Files"})]})})]}),"failed"===v&&(0,l.jsxs)(n.Zb,{children:[(0,l.jsxs)(n.Ol,{children:[(0,l.jsxs)(n.ll,{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"rounded-full h-5 w-5 bg-red-600"}),"Analysis Failed"]}),(0,l.jsx)(n.SZ,{children:"There was an issue processing your documents. Please try uploading again."})]}),(0,l.jsx)(n.aY,{children:(0,l.jsx)(i.z,{onClick:()=>k(!0),children:"Try Again"})})]}),(w||"idle"===v&&!j)&&(0,l.jsxs)(n.Zb,{children:[(0,l.jsxs)(n.Ol,{children:[(0,l.jsxs)(n.ll,{className:"flex items-center gap-2",children:[(0,l.jsx)(p.Z,{className:"h-5 w-5"}),"completed"===v?"Upload Additional Documents":"Upload Bank Statements"]}),(0,l.jsx)(n.SZ,{children:"Upload your PDF, CSV, or TXT bank statement files for analysis. Our AI will automatically categorize transactions and provide insights."})]}),(0,l.jsx)(n.aY,{children:(0,l.jsx)(r.p,{onUploadComplete:A,onError:O,className:"w-full"})})]}),S.length>0&&(0,l.jsxs)(n.Zb,{children:[(0,l.jsxs)(n.Ol,{children:[(0,l.jsxs)(n.ll,{className:"flex items-center gap-2",children:[(0,l.jsx)(u,{className:"h-5 w-5"}),"Recent Uploads"]}),(0,l.jsx)(n.SZ,{children:"Track the status of your recent file uploads and analysis progress"})]}),(0,l.jsx)(n.aY,{children:(0,l.jsx)("div",{className:"space-y-3",children:S.map(e=>(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)(h.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium",children:e.filename}),(0,l.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Uploaded ",e.uploadedAt.toLocaleString()]})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:["processing"===e.status&&(0,l.jsxs)("div",{className:"flex items-center gap-2 text-sm text-blue-600",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-600"}),"Processing"]}),"completed"===e.status&&(0,l.jsxs)("div",{className:"flex items-center gap-2 text-sm text-green-600",children:[(0,l.jsx)(m.Z,{className:"h-3 w-3"}),"Completed"]}),"failed"===e.status&&(0,l.jsxs)("div",{className:"flex items-center gap-2 text-sm text-red-600",children:[(0,l.jsx)("div",{className:"rounded-full h-3 w-3 bg-red-600"}),"Failed"]})]})]},e.id))})})]}),"idle"===v&&!j&&0===S.length&&!w&&(0,l.jsxs)(n.Zb,{children:[(0,l.jsxs)(n.Ol,{children:[(0,l.jsx)(n.ll,{children:"Getting Started"}),(0,l.jsx)(n.SZ,{children:"New to Bank Statement Analyzer? Here's how to get the most out of your analysis:"})]}),(0,l.jsx)(n.aY,{className:"space-y-4",children:(0,l.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"rounded-full bg-primary/10 p-2",children:(0,l.jsx)(p.Z,{className:"h-4 w-4 text-primary"})}),(0,l.jsx)("h3",{className:"font-semibold",children:"1. Upload Files"})]}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"Upload your bank statements in PDF, CSV, or TXT format"})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"rounded-full bg-primary/10 p-2",children:(0,l.jsx)("div",{className:"h-4 w-4 rounded-full bg-primary animate-pulse"})}),(0,l.jsx)("h3",{className:"font-semibold",children:"2. AI Analysis"})]}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"Our AI automatically categorizes and analyzes your transactions"})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"rounded-full bg-primary/10 p-2",children:(0,l.jsx)(h.Z,{className:"h-4 w-4 text-primary"})}),(0,l.jsx)("h3",{className:"font-semibold",children:"3. View Reports"})]}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"Get detailed insights and downloadable reports"})]})]})})]})]})}},34463:function(e,s,a){"use strict";a.d(s,{Ol:function(){return n},SZ:function(){return c},Zb:function(){return i},aY:function(){return o},ll:function(){return d}});var l=a(27573),t=a(7653),r=a(33495);let i=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,l.jsx)("div",{ref:s,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...t})});i.displayName="Card";let n=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,l.jsx)("div",{ref:s,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",a),...t})});n.displayName="CardHeader";let d=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,l.jsx)("h3",{ref:s,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",a),...t})});d.displayName="CardTitle";let c=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,l.jsx)("p",{ref:s,className:(0,r.cn)("text-sm text-muted-foreground",a),...t})});c.displayName="CardDescription";let o=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,l.jsx)("div",{ref:s,className:(0,r.cn)("p-6 pt-0",a),...t})});o.displayName="CardContent",t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,l.jsx)("div",{ref:s,className:(0,r.cn)("flex items-center p-6 pt-0",a),...t})}).displayName="CardFooter"},67899:function(e,s,a){"use strict";a.d(s,{Z:function(){return l}});let l=(0,a(59565).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},39135:function(e,s,a){"use strict";a.d(s,{Z:function(){return l}});let l=(0,a(59565).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])}},function(e){e.O(0,[609,251,117,52,195,293,286,744],function(){return e(e.s=69908)}),_N_E=e.O()}]);