"use strict";(()=>{var e={};e.id=912,e.ids=[912,944,919],e.modules={11185:e=>{e.exports=require("mongoose")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39491:e=>{e.exports=require("assert")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},63477:e=>{e.exports=require("querystring")},35034:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},17463:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>x,patchFetch:()=>b,requestAsyncStorage:()=>y,routeModule:()=>f,serverHooks:()=>w,staticGenerationAsyncStorage:()=>h});var n={};r.r(n),r.d(n,{GET:()=>m,POST:()=>m});var a=r(63036),i=r(5736),s=r(15262),o=r(59224),u=r.n(o),l=r(18452),c=r(50311),d=r(50944);let p={providers:[(0,l.Z)({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)return null;try{let t=await d.userRepository.findByEmailWithPassword(e.email);if(!t||!await c.ZP.compare(e.password,t.password))return null;return{id:t._id.toString(),email:t.email,name:t.name}}catch(e){return console.error("Authentication error:",e),null}}})],session:{strategy:"jwt"},pages:{signIn:"/login"},callbacks:{jwt:async({token:e,user:t})=>(t&&(e.id=t.id),e),session:async({session:e,token:t})=>(t&&e.user&&(e.user.id=t.id),e)},secret:process.env.NEXTAUTH_SECRET},m=u()(p),f=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/auth/[...nextauth]/route",pathname:"/api/auth/[...nextauth]",filename:"route",bundlePath:"app/api/auth/[...nextauth]/route"},resolvedPagePath:"/Users/shrijayan.rajendran/projects/personal/bank_statement/apps/web/src/app/api/auth/[...nextauth]/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:y,staticGenerationAsyncStorage:h,serverHooks:w}=f,x="/api/auth/[...nextauth]/route";function b(){return(0,s.patchFetch)({serverHooks:w,staticGenerationAsyncStorage:h})}},79128:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},59224:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var n={};Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i.default}});var a=r(79128);Object.keys(a).forEach(function(e){!("default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(n,e))&&(e in t&&t[e]===a[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}}))});var i=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(void 0);if(r&&r.has(e))return r.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&({}).hasOwnProperty.call(e,i)){var o=a?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,r&&r.set(e,n),n}(r(1295));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}Object.keys(i).forEach(function(e){!("default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(n,e))&&(e in t&&t[e]===i[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}}))})},18452:(e,t)=>{t.Z=function(e){return{id:"credentials",name:"Credentials",type:"credentials",credentials:{},authorize:()=>null,options:e}}},63036:(e,t,r)=>{e.exports=r(30517)},77919:(e,t,r)=>{r.d(t,{Z:()=>s});var n=r(11185),a=r.n(n);let i=global.mongoose;i||(i=global.mongoose={conn:null,promise:null});let s=async function(){if(i.conn)return i.conn;if(!i.promise){let e=process.env.MONGODB_URI;if(!e)throw Error("Please define the MONGODB_URI environment variable inside .env.local");i.promise=a().connect(e,{bufferCommands:!1}).then(e=>e)}try{i.conn=await i.promise}catch(e){throw i.promise=null,e}return i.conn}},50944:(e,t,r)=>{r.d(t,{userRepository:()=>l});var n=r(11185),a=r.n(n);let i=new n.Schema({name:{type:String,required:[!0,"Name is required"],trim:!0,maxlength:[100,"Name cannot exceed 100 characters"]},email:{type:String,required:[!0,"Email is required"],unique:!0,lowercase:!0,trim:!0,match:[/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/,"Please enter a valid email address"]},password:{type:String,required:[!0,"Password is required"],minlength:[6,"Password must be at least 6 characters long"]}},{timestamps:!0,collection:"users"}),s=a().models.User||a().model("User",i);var o=r(77919);class u{async ensureConnection(){process.env.JEST_WORKER_ID||await (0,o.Z)()}async findByEmail(e){await this.ensureConnection();let t=await s.findOne({email:e}).exec();return t?this.transformToPublicUser(t):null}async findById(e){await this.ensureConnection();let t=await s.findById(e).exec();return t?this.transformToPublicUser(t):null}async create(e){await this.ensureConnection();let t=new s({name:e.name,email:e.email,password:e.password}),r=await t.save();return this.transformToPublicUser(r)}async updateById(e,t){await this.ensureConnection();let r=await s.findByIdAndUpdate(e,{$set:t},{new:!0,runValidators:!0}).exec();return r?this.transformToPublicUser(r):null}async deleteById(e){return await this.ensureConnection(),!!await s.findByIdAndDelete(e).exec()}async existsByEmail(e){return await this.ensureConnection(),await s.countDocuments({email:e}).exec()>0}async findByEmailWithPassword(e){return await this.ensureConnection(),s.findOne({email:e}).exec()}transformToPublicUser(e){return{_id:e._id.toString(),name:e.name,email:e.email,createdAt:e.createdAt,updatedAt:e.updatedAt}}}let l=new u}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[522,295,311],()=>r(17463));module.exports=n})();